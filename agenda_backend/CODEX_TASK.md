Read class_appointments_plan.md

You must implement the feature exactly as specified.

Hard rules:
- never modify existing appointment logic
- maintain backward compatibility
- never refactor unrelated code
- use transactional booking
- prevent race conditions
- keep database isolated from Appointment tables

Execution order:
1) scan repository architecture
2) understand appointment system
3) propose implementation plan
4) wait for confirmation
5) implement step by step
